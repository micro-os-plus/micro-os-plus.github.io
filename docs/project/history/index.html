<!doctype html>

<html lang="en">


<head>

  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>Project history</title>
  <meta name="description" content="A POSIX inspired open source framework, written in C++.">

  <meta property="og:title" content="Project history" />
  <meta property="og:site_name" content="µOS++" />

  <link rel="alternate" type="application/rss+xml" title="µOS++" href="/feed.xml" />


  <meta property="article:published_time" content="2016-06-28">





  <meta name="google-site-verification" content="NT_y3tqI_8mrd8gYA_FDWHT2-tkJExOC6KBkSnyZx6c" />

  <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" type="text/css" href="/stylesheets/screen.css?202305210532" media="screen">
  <link rel="stylesheet" type="text/css" href="/stylesheets/font-awesome.css?202305210532" media="screen">
  <link rel="stylesheet" type="text/css" href="/stylesheets/print.css?202305210532" media="print">

  <link rel="canonical" href="/project/history/">



  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E9T84WD3CK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E9T84WD3CK');
</script>



</head>


<body>

<div class="container">

  <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.4";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

  <script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));</script>

  <div class="site-header">
  <table style="width:100%">
    <tr>
      <td>
        <a href="/">
          <img alt="Icon" class="site-icon" src="/assets/icons/wall-e-icon.png" height="100" width="100">
      </a>
      </td>
      <td>
        <table class="site-title" style="width:100%">
          <tr>
            <td class="site-title">
              <a href="/">µOS++</a>
            </td>
            <td class="site-motto" align="right">
              “Perfekt ist nicht gut genug”
            </td>
          </tr>
          <tr>
            <td class="site-description" colspan="2">
              A POSIX inspired open source framework, written in C++.
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</div>


</div>

<div class="container">

  <div class="wrapper">
    <div class="site-body">

      <div class="site-sidebar">


  <div class="custom-sidebar">
    <div class="boxed-group-inner">
      <h4 id="news"><a href="/blog/">News</a></h4>

<ul>
  <li><a href="/blog/2023/07/19/micro-os-plus-v7-0-0-released/">µOS++ v7.0.0 released</a></li>
  <li><a href="/blog/2021/05/21/micro-os-plus-v6-3-17-released/">µOS++ v6.3.17 released</a></li>
  <li><a href="/blog/2021/05/03/micro-os-plus-v6-3-16-released/">µOS++ v6.3.16 released</a></li>
  <li><a href="/blog/2021/01/22/micro-os-plus-first-scriptable-build/">First µOS++ scriptable build</a></li>
</ul>


    </div>
  </div>


  <div class="custom-sidebar">
    <div class="boxed-group-inner">
      
      <h4 id="home"><a href="/">Home</a></h4>

<h4 id="µos">µOS++</h4>

<ul>
  <li><a href="/micro-os-plus/">Overview</a></li>
  <li><a href="/micro-os-plus/iii/releases/">Releases</a></li>
</ul>

<h4 id="apis">APIs</h4>

<ul>
  <li><a href="/cmsis-plus/">Overview</a></li>
  <li><a href="/cmsis-plus/rtos/">RTOS API</a></li>
</ul>

<h4 id="xpacks">xPacks</h4>

<ul>
  <li><a href="/xpacks/">Overview</a></li>
</ul>

<h4 id="documentation">Documentation</h4>

<ul>
  <li>
<a href="/user-manual/">User’s <strong>manual</strong></a>
    <ul>
      <li><a href="/user-manual/getting-started/">Getting started</a></li>
      <li><a href="/user-manual/basic-concepts/">Basic concepts</a></li>
      <li><a href="/user-manual/features/">Features</a></li>
      <li><a href="/user-manual/threads/">Threads</a></li>
      <li><a href="/user-manual/thread-event-flags/">Thread event flags</a></li>
      <li><a href="/user-manual/semaphores/">Semaphores</a></li>
      <li><a href="/user-manual/event-flags/">Event flags</a></li>
      <li>Mutexes</li>
      <li>Condition variables</li>
      <li>Message queues</li>
      <li>Memory pools</li>
      <li>Software timers</li>
      <li>Clocks</li>
    </ul>
  </li>
  <li><a href="/reference/cmsis-plus/">µOS++ <strong>reference</strong></a></li>
</ul>

<h4 id="developer">Developer</h4>

<ul>
  <li><a href="/develop/">Overview</a></li>
  <li><a href="/reference/cmsis-plus/md_doxygen_pages_change-log.html">Change log</a></li>
  <li><a href="/develop/coding-style/">C++ coding style</a></li>
  <li><a href="/develop/naming-conventions/">Naming conventions</a></li>
  <li><a href="/develop/references/">Links &amp; references</a></li>
</ul>

<h4 id="support">Support</h4>

<ul>
  <li><a href="/support/">Overview</a></li>
  <li><a href="/support/known-issues/">Known issues</a></li>
  <li><a href="/support/faq/">FAQ</a></li>
  <li><a href="/support/forum/">Forum</a></li>
  <li><a href="https://github.com/micro-os-plus/micro-os-plus-iii/issues/">Report µOS++ issues</a></li>
</ul>

<h4 id="latest-articles">Latest Articles</h4>

<ul>
  <li><a href="/articles/arm-com-2016-06-24/">CMSIS++ RTOS: fully functional reference implementation</a></li>
  <li><a href="/articles/arm-com-2016-03-11/">CMSIS++: a proposal for a future CMSIS, written in C++</a></li>
</ul>

<h4 id="project">Project</h4>

<ul>
  <li><a href="/project/about/">About</a></li>
  <li><a href="/project/history/">History</a></li>
  <li><a href="https://opensource.org/licenses/MIT">License (MIT)</a></li>
</ul>

    </div>
  </div>

  <div class="site-theme">
    This site uses the <a href="https://github.com/ilg-ul/github-jekyll-theme">GitHub Wiki-like</a> theme by <a href="https://github.com/ilg-ul">Liviu Ionescu</a>.
  </div>

</div>


      <div class="site-content">

        
<h1 class="page-title">Project history</h1>
<table id="last-modified">
  <tr>
    <td id="last-modified">Last modified on Sat Jul 22 11:13:52 2023 UTC.</td>
    <td id="improve" align="right"><a id="improve" href="https://github.com/micro-os-plus/web-jekyll/edit/master/pages/project/history.md"><i class="fa fa-pencil"></i>  Improve this page</a></td>
  </tr>
</table>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> A major milestone was reached in July 2023,
with v7.0.0, the first release that came with fully automated tests.</div>

<h2 id="the-early-years---a-personal-journey">The early years - a personal journey</h2>

<p>My interest in system programming dates from the first moments when
I started to play with computers. After learning FORTRAN in my first
high school year, I wondered how does the refrigerator size box
understand my
programs and how is it able to run multiple jobs at the same time.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> The journey from this child curiosity
to µOS++ was long and fascinating.</div>

<h3 id="the-unix-era-and-the-first-scheduler">The Unix era and the first scheduler</h3>

<p>In 1985 I met <strong>Unix</strong> for the first time, running on a PDP-11 compatible
mini-computer and, remarkable for those years, also accompanied by a
tape with the
<a href="http://en.wikipedia.org/wiki/Version_7_Unix">Version 7 Unix</a> source code.</p>

<p>Not only that I studied it thoroughly, but by 1989 I already had <strong>a functional
C compiler</strong> ported on <a href="http://en.wikipedia.org/wiki/68000">Motorola MC68000</a>
microprocessor, and a <strong>good knowledge of the Unix kernel</strong>.</p>

<p>This knowledge of the <strong>context switching mechanism</strong> was put to test when
I needed a multi-threaded scheduler running on
<a href="http://en.wikipedia.org/wiki/Z80">Zilog Z80</a>; later it was successfully
used in a commercial product (a telex machine).</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> This scheduler can be considered
the precursor of µOS++.</div>

<h3 id="the-ecos-experience-cdl--c">The eCos experience (CDL &amp; C++)</h3>

<p>In the first years of the 2000s I was involved in a project
running on the <a href="http://en.wikipedia.org/wiki/I960">Intel i960</a> CPU,
which also required a multi-threaded system.</p>

<p>To implement it, I chose <a href="http://ecos.sourceware.org">eCos</a>, which was the
major RTOS available as open source and with a permissive license.</p>

<p>There were many remarkable things to be noted about <strong>eCos</strong>, but
relevant for this story are two: first, at its core, it was <strong>written in C++</strong>,
(a language that I met in 1990 when I ported the <strong>AT&amp;T C++ translator</strong> on
lots of Unix machines)
and, second, that it came with an elaborate <strong>mechanism for managing
project configurations</strong>, the
<a href="http://ecos.sourceware.org/docs-1.3.1/cdl/language.html">eCos CDL</a>,
which used <a href="https://en.wikipedia.org/wiki/Tcl">TCL</a> scripts to
define the configuration metadata.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> C++ is the reason behind the <strong>++</strong> in µOS++,
and eCos CDL is the reason behind
using a component based design for the planned
<strong>xPack Project Builder</strong> (tentatively called <strong>xpmake</strong>).</div>

<p>By that time, <code class="language-plaintext highlighter-rouge">vi</code> and <code class="language-plaintext highlighter-rouge">make</code> appeared to be my friends, but the
experience of manually maintaining the <strong>make</strong> files turned into a
nightmare.</p>

<h2 id="why-a-new-embedded-operating-system">Why a new embedded operating system?</h2>

<p>There were many embedded operating systems available by the time
this project was initiated. However, the context I planned to use
this embedded system was slightly more specific, i.e. as firmware for
aviation instruments to be used in ultralight aircraft.</p>

<p>I started to experiment with aviation instruments several years before,
and one determining factor on the decision was an article stating
that for the design of aviation instruments, a framework is acceptable
if it allows to complete the design within one day. Although this
seems rather extreme, the idea is quite valid, and has important
consequences.</p>

<p>The first consequence is that <strong>it promotes modular design</strong>, i.e.
instead of a do-it-all box (a kind of a <em>Swiss army knife</em> like design),
it is better to split the design into multiple independent modules,
each performing a specific job.</p>

<p>The second consequence is that <strong>the framework should be very well
structured</strong>, easily configurable and as light as possible, in order
to run with limited resources on simple processors. By well structured
I mean modular, object oriented design, favouring a high degree of
code reuse, both between related projects, and between different
hardware platforms.</p>

<p>After a long and detailed search, there were many partial solutions
identified, but none was able to address all the requirements; so,
based on my previous experience with multi-tasking systems, the
decision to develop an in-house solution came naturally.</p>

<p>However, this decision was clouded from the very beginning by a doubt:
<em>“How do I know that my software really works as expected?”</em> And
<em>“What is the best way to ensure that everything still works fine
after I make some changes?”</em>.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> This is where the need for thorough
testing comes into play. This permanent quest to improve the quality
will eventually lead
to the kindred <strong>xPack project</strong>, as a tool to automate testing.</div>

<h2 id="why-c">Why C++?</h2>

<p>The decision for <strong>C++</strong> was a tough one, and I’m convinced it raises
a lot of questions and critics. However, I’m also convinced that it was
a good decision, and, those who take the time to seriously consider
it, will probably reach to the same conclusion.</p>

<p>First of all, by C++ I do not mean the full C++ implementation, but
a limited subset: no real time typing, possibly no multiple inheritance,
limited or no use of exceptions.</p>
<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> Writing object oriented code
is also possible in C, but the syntax is significantly more
complicated.</div>

<p>One common argument against C++ is the alleged performance
penalty, but most of those who claim this have no compiler expertise,
since for the subset of C++ that is needed for embedded applications
the performance gain for C vs C++ is null for regular classes, and
almost null for classes that require polymorphism.</p>

<p>Finally, the contributing factor on making the decision to use
C++ came after reading Michael Barr’s book,
<a href="http://www.amazon.com/Programming-Embedded-Systems-C/dp/1565923545">Programming Embedded Systems in C and C++</a>,
that came with some good code samples written in C++.</p>

<h2 id="the-µos-first-edition">The µOS++ first edition</h2>

<h3 id="the-original-avr8-version">The original AVR8 version</h3>

<p>In the second half of the 2000s decade, I was searching for a solution
to write firmware for simple aviation instruments, running on
AVR-class microcontrollers. With eCos too heavy for resource restrained
devices, I decided to reimplement the Z80 scheduler on the
<a href="http://en.wikipedia.org/wiki/AVR8">Atmel AVR8</a> microcontroller, and in 2007
I had the first functional version of
<a href="https://github.com/micro-os-plus/micro-os-plus-i">µOS++</a>.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> Although the initial version ran
only on AVR8, the design was modular
and portable from the very beginning.</div>

<p>Central to the µOS++ design was the <strong>scheduler</strong> and the low-level
<strong>synchronisation primitives</strong>. Based on my previous Unix experience,
the main synchronisation primitives were inspired by the original
Unix <code class="language-plaintext highlighter-rouge">sleep()</code> and <code class="language-plaintext highlighter-rouge">wakeup()</code> primitives. Later they were changed
to better match the needs of multi-threaded systems,
but the basic functionality was more or less the same.</p>

<h3 id="the-eclipse-encounter">The Eclipse encounter</h3>

<p>Given the bad experience I had with manually maintaining <strong>make</strong> files,
it is no surprise that when I first met Eclipse, and discoverd
<a href="https://github.com/eclipse-cdt/">CDT</a>,
I immediately started to searched for a solution to use it for µOS++.</p>

<h3 id="gnu-arm-eclipse">GNU ARM Eclipse</h3>

<p>The initial use of Eclipse CDT was quite difficult, since direct support for
embedded toolchains was not available.</p>

<p>At the same time I started to play with the new
<a href="https://en.wikipedia.org/wiki/ARM_Cortex-M">Arm Cortex-M</a> devices,
which looked very promising, given how easy it is to implement the
context switching code and the scheduler timer.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> The GNU ARM Eclipse was born,
as a solution that greatly simplified
the build process for µOS++ Cortex-M projects,
given the <strong>CDT managed build</strong> system,
which automatically generated the <strong>make</strong> files.</div>

<h3 id="the-arm-cortex-m3-preliminary-port">The ARM Cortex M3 preliminary port</h3>

<p>In 2009 the µOS++ was easily ported to
<a href="https://en.wikipedia.org/wiki/ARM_Cortex-M">ARM Cortex M3</a>,
during an evaluation phase for the next generation of the
aviation instruments.</p>

<h3 id="the-avr32-port">The AVR32 port</h3>

<p>A more difficult and complex port of µOS++ was the
<a href="http://en.wikipedia.org/wiki/AVR32">Atmel AVR32</a> port, done in 2011.
The difficulty was inherent to the hardware design of the AVR32
architecture, way less software-friendly than the ARM Cortex M3
(my personal feeling is that the ARM Cortex M3 design team
included a software guy, with good knowledge of operating system
intricacies, while the AVR32 architecture seems to be designed by
a team where access for software guys was strictly forbidden).</p>

<p>But not everything was bad with the AVR32 experience: since
this architecture uses 4 nested interrupts levels, now the µOS++
is able to properly handle nested interrupts.</p>

<p>Another significant addition to µOS++ was a mechanism to handle
very fast interrupts, required for some Hard Real Time applications.</p>

<h3 id="the-testing-dead-end">The testing dead-end</h3>

<p>The initial enthusiasm of using Eclipse for building µOS++ applications
was soon
shaded by <strong>the difficulties of building and running tests in a scriptable
environment</strong>.</p>

<p>It must be mentioned that Eclipse CDT advertises a way of
running headless builds, but it proved unreliable, so the only
way of running test was manually, as regular Eclipse projects, which
was very inconvenient, to say the least.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> With µOS++ already used in some
commercial projects, I was afraid that the lack of proper testing
will eventually bite; it did not, but each release still came with
a good load of stress.</div>

<h2 id="the-µos-second-edition">The µOS++ second edition</h2>

<h3 id="the-xcdl-experimental-version">The XCDL experimental version</h3>

<p>The need for a second edition of µOS++ became obvious while
using it for several commercial projects, and active work
started in early 2013, after the
<a href="http://xcdl.github.io">XCDL</a> (eXtended Components Definition Language)
project, implemented in Python, become functional.</p>

<p>The major criticism of the first edition was the lack of support for
<a href="http://en.wikipedia.org/wiki/Continuous_integration">Continuous Integration</a> and
<a href="http://en.wikipedia.org/wiki/Test-driven_development">Test Driven Development</a>,
requirements more and more expected for modern projects.</p>

<p>Starting from scratch, the first version of a unit testing infrastructure
was implemented on the macOS synthetic platform.</p>

<p>The new system was renamed
<a href="https://github.com/micro-os-plus/micro-os-plus-ii">µOS++ SE</a> as the
<strong>Second Edition</strong>.</p>

<p>The µOS++ SE project wiki was created, initially
hosted in the SourceForge project web space, then moved to a private
domain due to major SourceForge shortcomings.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> The experience with the XCDL component
based configuration and build
system was considered a success, and it validated the concept.</div>

<p>The major weakness was the limitation introduced by
having the build configuration metadata as a Python code:
it could be edited only manually, and not via a GUI based
IDE, like, for example, the C/C++ settings in Eclipse CDT,
which writes back the XML configuration file.</p>

<h3 id="the-cortex-m-port">The Cortex-M port</h3>

<p>In April 2013 the general framework with functional startup
code for STM32F1 and STM32F4 was implemented and tested on several
development boards.</p>

<h3 id="functional-full-version">Functional full version</h3>

<p>The project grew steadily, with the scheduler running on most STM32Fx
cores (in pre-emptive mode), and on synthetic POSIX platforms
(OS X and GNU/Linux, in cooperative mode). The sources compiled
without warnings on GCC 4.7, GCC 4.8 and LLVM clang 3.2/3.3,
in 32/64-bit variants, and a multitude of tests were running
on OS X and Ubuntu.</p>

<p>The repository increased steadily, and in October 2013 it numbered
more than 700 files, with more than 150K lines.</p>

<p>Acknowledging the need for a better Eclipse integration, in October 2013
the development was temporarily interrupted, with focus changed to
GNU ARM Eclipse plug-ins, later rebranded as the
<a href="https://eclipse-embed-cdt.github.io">Eclipse Embedded CDT</a>.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> The quest for a solution to
automate testing continued, with no answer in the short term.</div>

<h2 id="the-µos-third-edition">The µOS++ third edition</h2>

<h3 id="february-2014">February 2014</h3>

<p>The need for the third edition of µOS++ become evident after the
experience with GNU ARM Eclipse plug-ins and the obvious need to
better integrate µOS++ with Eclipse.</p>

<p>Work on µOS++ IIIe officially started with the creation of a new
Git repository <a href="https://github.com/micro-os-plus">micro-os-plus</a>
and a new <a href="http://micro-os-plus.github.io">web</a>.</p>

<h3 id="cmsis-packages">CMSIS packages</h3>

<p>In mid 2014 the documentation for the new
<a href="https://www.open-cmsis-pack.org">ARM CMSIS Packs</a> was
released; some evaluations were performed with the Keil tools and
an experimental package manager was implemented as an Eclipse plug-in;
something derived from the CMSIS packages was considered to be a possible
candidate for a distribution mechanism, but later the idea was dismissed,
as unsuitable.</p>

<p>Also a more C-friendly approach was adopted, by adding <strong>C wrappers</strong> to the
core C++ API.</p>

<h3 id="more-and-more-testing">More and more testing</h3>

<p>Compared to the previous edition, testing was more thorough,
using the <strong>CMSIS OS Validator</strong> and several stress tests. The majority
of tests were performed via the synthetic POSIX platform on macOS
and Linux; another fair share of the tests were performed via QEMU
on the emulated STM32F4DISCOVERY, and only a very small were performed
on physical hardware.</p>

<p>But, as the number of tests and their complexity grew,
the problem of automating these tests became more and more critical.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> I ended with the tests split
across multiple projects, each with multiple
Eclipse projects, each with different prerequisites and workflows to build
and invoke the tests, up to the point when everything became
un-manageable.</div>

<h3 id="the-xcdl-packages-and-the-migration-to-github">The XCDL packages and the migration to GitHub</h3>

<p>Further research concluded that CMSIS Packs alone are not enough,
and a more elaborate solution is necessary; initially the
<a href="https://github.com/ARMmbed/yotta">yotta</a> tool was considered,
and in late 2015 the first XCDL packs format based on yotta were tested.</p>

<p>In December 2015 the project was migrated to GitHub and restructured as
XCDL packs, stored as separate sub-projects.</p>

<p>Later Arm decided to discontinue development for yotta,
and another solution was needed.</p>

<h3 id="cmsis">CMSIS++</h3>

<p>In January 2016, the CMSIS++ repository was created, with a double intent:
to act as a proposal for the next generation CMSIS, due in June 2016,
and to serve as a portable API for the third edition of µOS++.</p>

<p>Unfortunately, the experience with CMSIS RTOS, CMSIS Drivers and
other components
was disappointing (to say the least), and further support for CMSIS
was no longer considered appropriate.</p>

<h3 id="risc-v">RISC-V</h3>

<p>In mid 2017 support for <strong>RISC-V</strong> was added and, for more portability,
the use of the CMSIS name, associated with ARM, was discontinued.</p>

<h3 id="the-npmxpm-era">The npm/xpm era</h3>

<p>While searching for a new solution to automate the tests for
the µOS++ projects, I discovered
<a href="https://en.wikipedia.org/wiki/Npm_(software)">npm</a> as the industry
standard package manager for JavaScript packages, and the
<a href="https://www.npmjs.com">npmjs.com</a> as the hugely popular public
repository, with millions of packages and billions of downloads.</p>

<p>I contacted Isaac Schlueter, its author, and asked if it is acceptable to
use the repository for non-JavaScript packages; he replied that unless
I do something really stupid like storing my photo library there,
nobody will chase down my packages.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> This was a very kind answer,
and it was the turning point
in the xPack project, which became part of the node/npm ecosystem.</div>

<p>On April 2017 the first release of <strong>xpm</strong> was ready, and packages
managed by it were named <strong>xPacks</strong>.</p>

<h3 id="the-binary-xpacks">The binary xPacks</h3>

<p>In the initial design, the xPacks were intended to store C/C++ source
files, and they worked just fine.</p>

<p>However, while <strong>xpm</strong> was used to automate testing, it was noted that
tests need to run with multiple toolchains, even multiple
versions of the same
toolchain, and these tools can also be defined as <code class="language-plaintext highlighter-rouge">devDependencies</code>
(development dependencies).</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> <strong>xpm</strong> was extended to also support
installing binary packages, and a new class of tools was created as
<a href="https://github.com/xpack-dev-tools/">xPack 3rd Party Development Tools</a>.</div>

<h3 id="the-xpack-build-box-xbb-nightmare">The xPack Build Box (XBB) nightmare</h3>

<p>Building the multi-platform binary packages proved a very difficult
task. The challenge was how to address the contradiction between having to
build the <strong>very latest tools</strong> that run on <strong>very old
versions</strong> of the corresponding operating systems (Windows, GNU/Linux
and macOS).</p>

<p>The initial <a href="https://github.com/xpack/xpack-build-box">XBB</a>
solution was to start with a Docker image of an old release
(Ubuntu 12, to also provide support for RedHat 7), and compile from
sources the required new versions of the compilers and other
development tools.
Unfortunately this was not always possible directly,
and an extra step was needed,
to compile a bootstrap set of tools with some slightly older versions,
and with them
to compile the most recent versions.</p>

<p>This got more and more complicated, and the Docker image grew to
4-5 GB; the builds took many hours to complete,
especially for the Raspberry Pi OS images.</p>

<p>The solution was functional, it eventually allowed to build all GCC
toolchains,
native and cross for Arm &amp; RISC-V, but maintenance for the Docker
images was close to <em>mission impossible</em>; after the second
release it was evident that this is a dead end and a
better solution is needed.</p>

<h3 id="the-xbb-breakthrough">The XBB breakthrough</h3>

<p>In the last months of 2022, work on a new XBB release started, and was
completed in February 2023, with XBB v5.0.0.</p>

<p>The new solution was a big improvement, since it used completely
standard Ubuntu 18 Docker images, without any customisations, and all modern
tools were installed with <strong>xpm</strong> as existing binary xPacks.</p>

<p>This was a <strong>major milestone</strong> in the life of xPack project, since it
proved two things:</p>

<ul>
  <li>that <strong>the technology is standalone</strong> with the newer versions of the tools
being built with existing xPacks</li>
  <li>that the <strong>xpm</strong> workflow is <strong>generic enough</strong> to be usable not only for
small embedded projects, but for complex tools, like compilers.</li>
</ul>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> With this milestone reached, the problem of
binary dependencies required for
µOS++ was considered solved. The light at the end of the tunnel was real,
xPacks will eventually automate testing for the µOS++ projects.</div>

<h3 id="µtest---a-lightweight-testing-framework-for-embedded-platforms">µTest++ - a lightweight testing framework for embedded platforms</h3>

<p>The early µOS++ tests used the CMSIS OS validation suite, and there
were several attempts to use a testing framework for other tests,
but the results were unsatisfactory,
since the frameworks required a lot of resources.</p>

<p>Further work was done with
<a href="https://github.com/xpack-3rd-party/boost-ut-xpack">Boost UT</a>,
<a href="https://github.com/xpack-3rd-party/catch2-xpack">Catch2</a>,
<a href="https://github.com/xpack-3rd-party/googletest-xpack">GoogleTest</a>,
which resulted in functional packages that can be used in projects.</p>

<p>They were all functional, but quite heavy and not really suited
for testing embedded projects; thus a lighter solution was considered.</p>

<p>This resulted in
<a href="https://github.com/micro-os-plus/micro-test-plus-xpack">µTest++</a>,
released in February 2021,
which was initially inspired by <a href="https://node-tap.org">node tap</a>.</p>

<p>In a later iteration it was reworked, and since v3.x (released in
April 2022), it provides most of the <strong>Boost UT</strong> primitives,
but with a lighter footprint.</p>

<h3 id="the-utils-list-source-code-xpack">The utils-list source code xPack</h3>

<p>With most of the tools in place, the
<a href="https://github.com/micro-os-plus/utils-lists-xpack/">@micro-os-plus/utils-lists</a>
project was selected as the first candidate to be fully tested
using the new xPack tools.</p>

<p>The result was a very large set of tests, running both on the native
platform (gcc and clang), and on lots of embedded platforms
(Arm <strong>Cortex-M0 &amp; M7</strong>, <strong>Cortex A15 &amp; A72</strong>, <strong>RISC-V 32/64</strong>), running on
QEMU. I doubt that there are many projects so thoroughly tested
on so many platforms and build tools.</p>

<div class="alert alert-info" role="alert">
<i class="fa fa-info-circle"></i> <b>Note:</b> This was finally in line with the
expectations. There are good chances
that the automation provided by xPacks will allow me to sleep well
after each µOS++ release.</div>

<h3 id="the-doxygen-configuration">The Doxygen configuration</h3>

<p>In April 2023 the documentation for the project was <strong>utils-list</strong>
added, using
a site generated by Doxygen and a custom CSS theme, resulting in a
nice <a href="https://micro-os-plus.github.io/utils-lists-xpack/">web site</a>.</p>

<h3 id="µos-v700---the-first-fully-tested-release">µOS++ v7.0.0 - the first fully tested release</h3>

<p>A major milestone was reached in July 2023: after updating the project
to the more strict requirements of modern toolchains (GCC &amp; clang),
the tests that previously were performed manually in Eclipse were
reworked to use CMake and the workflow was fully automated with
<strong>xpm</strong> in order to allow the multi-platform tests to run in
scriptable CI environments, like GitHub Actions.</p>

<p>The tests run natively on the synthetic POSIX platform (macOS &amp; GNU/Linux)
compiled with multiple GCC &amp; clang versions,
and on Cortex-M0+/M3/M7F, emulated by QEMU.</p>

<h2 id="the-µos-fourth-edition">The µOS++ fourth edition</h2>

<p>The next edition of µOS++ aims to further modularise the project
in order to better test each separate module.</p>

<p>Work has already started to replace the monolithic repository
with multiple xpm/npm packages.</p>

<h3 id="to-be-continued">To be continued</h3>

<p>…</p>








<ul class="share-buttons">
  <li><div class="tw-share-button"><a href="https://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a></div></li>
  <li><div class="fb-share-button" data-href="http://micro-os-plus.github.io/project/history/" data-layout="button"></div></li>
</ul>



      </div>

    </div>
  </div>

</div>

<div class="container">

  <div class="site-footer">
  <div class="site-footer-links left">
    <ul>
  <li>© 2023 Liviu Ionescu</li>
  <li>Hosted on GitHub</li>
  <li><a href="/feed.xml"><img src="/assets/images/feed-20.png" alt="RSS"></a></li>
  <li>
<a href="http://twitter.com/micro_os_plus" class="twitter-follow-button" data-show-count="false">Follow @micro_os_plus</a><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</li>
</ul>


  </div>
  <a href="https://github.com/micro-os-plus/micro-os-plus-iii" aria-label="Homepage">
      <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
  </a>
  <div class="site-footer-links right">
    <ul>
  <li><a href="/">Home</a></li>
  <li><a href="/blog/">News</a></li>
  <li><a href="https://github.com/micro-os-plus/micro-os-plus-iii/releases">Releases</a></li>
  <li><a href="https://github.com/micro-os-plus/micro-os-plus-iii/issues">Support</a></li>
  <li><a href="/about/">About</a></li>
</ul>

  </div>
</div>


</div>

</body>
</html>
