<!DOCTYPE html>
<html lang="en">


<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>Application configuration</title>
  <meta name="description" content="The third edition of µOS++, a POSIX inspired open source framework, written in C++.">

  <meta property="og:title" content="Application configuration">
  <meta property="og:site_name" content="µOS++ IIIe">

  <link rel="alternate" type="application/rss+xml" title="µOS++ IIIe" href="/feed.xml">


  <meta property="article:published_time" content="2011-05-24">





  <meta name="google-site-verification" content="NT_y3tqI_8mrd8gYA_FDWHT2-tkJExOC6KBkSnyZx6c">

  <link href="https://fonts.googleapis.com/css?family=Architects+Daughter" rel="stylesheet" type="text/css">

  <link rel="stylesheet" type="text/css" href="/stylesheets/screen.css?201807041643" media="screen">
  <link rel="stylesheet" type="text/css" href="/stylesheets/font-awesome.css?201807041643" media="screen">
  <link rel="stylesheet" type="text/css" href="/stylesheets/print.css?201807041643" media="print">

  <link rel="canonical" href="/micro-os-plus/i/Application_configuration/">



  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-16767008-14', 'auto');
  ga('send', 'pageview');

</script>



</head>


<body>

<div class="container">

  <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.4";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

  <script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));</script>

  <div class="site-header">
  <table style="width:100%">
    <tr>
      <td>
        <a href="/">
          <img alt="Icon" class="site-icon" src="/assets/icons/wall-e-icon.png" height="100" width="100">
      </a>
      </td>
      <td>
        <table class="site-title" style="width:100%">
          <tr>
            <td class="site-title">
              <a href="/">µOS++ IIIe</a>
            </td>
            <td class="site-motto" align="right">
              “Perfekt ist nicht gut genug”
            </td>
          </tr>
          <tr>
            <td class="site-description" colspan="2">
              The third edition of µOS++, a POSIX inspired open source framework, written in C++.
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</div>


</div>

<div class="container">

  <div class="wrapper">
    <div class="site-body">

      <div class="site-sidebar">


  <div class="custom-sidebar">
    <div class="boxed-group-inner">
      <h4 id="news"><a href="/blog/">News</a></h4>

<ul>
  <li><a href="/blog/2021/01/22/micro-os-plus-first-scriptable-build/">First µOS++ scriptable build</a></li>
  <li><a href="/blog/2018/11/19/micro-os-plus-v6-3-15-released/">µOS++ IIIe v6.3.15 released</a></li>
  <li><a href="/blog/2018/07/04/micro-os-plus-v6-3-14-released/">µOS++ IIIe v6.3.14 released</a></li>
  <li><a href="/blog/2017/08/26/micro-os-plus-v6-3-13-released/">µOS++ IIIe v6.3.13 released</a></li>
</ul>


    </div>
  </div>


  <div class="custom-sidebar">
    <div class="boxed-group-inner">
      
      <h4 id="home"><a href="/">Home</a></h4>

<h4 id="µos-iiie">µOS++ IIIe</h4>

<ul>
  <li><a href="/micro-os-plus/">Overview</a></li>
</ul>

<h4 id="apis">APIs</h4>

<ul>
  <li><a href="/cmsis-plus/">Overview</a></li>
  <li><a href="/cmsis-plus/rtos/">RTOS API</a></li>
</ul>

<h4 id="xpacksxcdl">xPacks/XCDL</h4>

<ul>
  <li><a href="/xpacks/">Overview</a></li>
</ul>

<h4 id="documentation">Documentation</h4>

<ul>
  <li>
<a href="/user-manual/">User’s <strong>manual</strong></a>
    <ul>
      <li><a href="/user-manual/getting-started/">Getting started</a></li>
      <li><a href="/user-manual/basic-concepts/">Basic concepts</a></li>
      <li><a href="/user-manual/features/">Features</a></li>
      <li><a href="/user-manual/threads/">Threads</a></li>
      <li><a href="/user-manual/thread-event-flags/">Thread event flags</a></li>
      <li><a href="/user-manual/semaphores/">Semaphores</a></li>
      <li><a href="/user-manual/event-flags/">Event flags</a></li>
      <li>Mutexes</li>
      <li>Condition variables</li>
      <li>Message queues</li>
      <li>Memory pools</li>
      <li>Software timers</li>
      <li>Clocks</li>
    </ul>
  </li>
  <li><a href="/reference/cmsis-plus/">µOS++ <strong>reference</strong></a></li>
</ul>

<h4 id="developer">Developer</h4>

<ul>
  <li><a href="/develop/">Overview</a></li>
  <li><a href="/reference/cmsis-plus/md_doxygen_pages_change-log.html">Change log</a></li>
  <li><a href="/develop/coding-style/">C++ coding style</a></li>
  <li><a href="/develop/naming-conventions/">Naming conventions</a></li>
  <li><a href="/develop/references/">Links &amp; references</a></li>
</ul>

<h4 id="support">Support</h4>

<ul>
  <li><a href="/support/">Overview</a></li>
  <li><a href="/support/known-issues/">Known issues</a></li>
  <li><a href="/support/faq/">FAQ</a></li>
  <li><a href="/support/forum/">Forum</a></li>
  <li><a href="https://github.com/micro-os-plus/micro-os-plus-iii/issues/">Report µOS++ IIIe issues</a></li>
</ul>

<h4 id="latest-articles">Latest Articles</h4>

<ul>
  <li><a href="/articles/arm-com-2016-06-24/">CMSIS++ RTOS: fully functional reference implementation</a></li>
  <li><a href="/articles/arm-com-2016-03-11/">CMSIS++: a proposal for a future CMSIS, written in C++</a></li>
</ul>

<h4 id="license">License</h4>

<ul>
  <li><a href="https://opensource.org/licenses/MIT">MIT</a></li>
</ul>

<h4 id="about"><a href="/about/">About</a></h4>

    </div>
  </div>

  <div class="site-theme">
    This site uses the <a href="https://github.com/ilg-ul/github-jekyll-theme">GitHub Wiki-like</a> theme by <a href="https://github.com/ilg-ul">Liviu Ionescu</a>.
  </div>

</div>


      <div class="site-content">

        
<h1 class="page-title">Application configuration - DEPRECATED</h1>
<table id="last-modified">
  <tr>
    <td id="last-modified">Page date Tue May 24 23:04:46 2011 .</td>
    <td id="improve" align="right"><a id="improve" href="https://github.com/micro-os-plus/web-jekyll/edit/master/pages/micro-os-plus/i/Application_configuration.md"><i class="fa fa-pencil"></i>  Improve this page</a></td>
  </tr>
</table>

<div id="toc-container">
<table class="toc" id="toc">
<tbody>
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toc_level-1 toc_section-1">
<a href="#app_definesh"><span class="tocnumber">1</span> <span class="toctext">App_Defines.h</span></a>
</li>
<li class="toc_level-1 toc_section-2">
<a href="#os_app_definesh"><span class="tocnumber">2</span> <span class="toctext">OS_App_Defines.h</span></a>
</li>
<li class="toc_level-1 toc_section-3">
<a href="#os_definesh"><span class="tocnumber">3</span> <span class="toctext">OS_Defines.h</span></a>
</li>
<li class="toc_level-1 toc_section-4">
<a href="#osh-for-system-classes"><span class="tocnumber">4</span> <span class="toctext">OS.h (for system classes)</span></a>
</li>
<li class="toc_level-1 toc_section-5">
<a href="#uosh-for-application-classes"><span class="tocnumber">5</span> <span class="toctext">uOS.h (for application classes)</span></a>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<h1 id="the-short-story">The short story</h1>

<p>The recommended method of including configuration definitions in µOS++ projects is to use the <strong>uOS.h</strong> file</p>

<div class="language-plaintext highlighter-rouge">
<div class="highlight">
<pre class="highlight">
<code>#include "portable/kernel/include/uOS.h"
</code></pre>
</div>
</div>

<p>This file should be included in the <strong>main.cpp</strong> file, and in all class header files.</p>

<p>Each µOS++ project should define two distinct header files, one for the application specific files and one for system specific files. The preferred location for these files is <strong>${ProjDirPath}/include</strong>.</p>

<h2 id="app_definesh">App_Defines.h</h2>

<p>Since all application files include uOS.h, extending the system definitions with application specific definitions can be conveniently done by including a custom header file <strong>at the end</strong> of uOS.h, <strong>after most of the other system include files</strong>.</p>

<p>This custom file is called App_Defines.h, and it’s purpose is to extend the uOS.h header with application specific definitions, not to redefine system definitions.</p>

<p>By using this approach, application specific definitions in App_Defines.h can be based on all existing system definitions, for example:</p>

<div class="language-plaintext highlighter-rouge">
<div class="highlight">
<pre class="highlight">
<code>#define APP_CFGINT_TASKBLINK_TICKS          (OS_CFGINT_TICK_RATE_HZ)
</code></pre>
</div>
</div>

<h2 id="os_app_definesh">OS_App_Defines.h</h2>

<p>Similarly, all µOS++ system files include at least <strong>portable/kernel/include/OS_Defines.h</strong>, as a common point for all system related defines. This file performs a hierarchical sequence of inclusions, from particular to general, assuming that each level will add defaults for definitions not yet encountered.</p>

<p>In other terms, if a definition is not present in the application file, the board file might define it, otherwise the family/architecture related files might define it.</p>

<p>So the application definitions have the higher precedence and should not be overwritten by board/family/architecture definitions.</p>

<p>This also means that in this structure the board/family/definitions are not available in OS_App_Defines.h.</p>

<p>On the other hand, due to this specific inclusion order, definitions in the system headers are available in the application headers, so if these two files need to make conditional preprocessing, the <strong>#define</strong> present in OS_App_Defines.h is available for any <strong>#if defined()</strong> in App_Defines.h.</p>

<h1 id="the-long-story">The long story</h1>

<h2 id="os_definesh">OS_Defines.h</h2>

<p>One of the build characteristics of µOS++ is that, at the limit, any project should build without errors with all µOS++ source files, regardless of architecture/family/board specifics.</p>

<p>In order for this to work, each non portable source file should check if the proper target is selected and skip if necessary.</p>

<div class="language-plaintext highlighter-rouge">
<div class="highlight">
<pre class="highlight">
<code>#include "portable/kernel/include/OS_Defines.h"

#if defined(OS_CONFIG_ARCH_ARM_CORTEX_M3)

#include "portable/kernel/include/OS.h"

...

#endif /* defined(OS_CONFIG_ARCH_ARM_CORTEX_M3) */
</code></pre>
</div>
</div>

<p>As seen above, the minimum requirement for all system files, either C/C++ or assembly is to include the OS_Defines.h header file. If more system definitions are needed, the alternative is to use the OS.h header file.</p>

<p>The inclusion chain in OS_Defines.h is:</p>

<ul>
  <li>define absolute variables, like <strong>OS versions</strong>, in integer and string format</li>
  <li>include <strong>OS_App_Defines.h</strong>
</li>
  <li>based o the board definition, selectively include <strong>OS_Board_Defines.h</strong>
</li>
  <li>based on the architecture family definition, selectively include <strong>OS_Family_Defines.h</strong>
</li>
  <li>based on the architecture definition, selectively include <strong>OS_Arch_Defines.h</strong>
</li>
  <li>define <strong>defaults</strong> for various definitions</li>
  <li>define <strong>interdependencies</strong> for various definitions</li>
</ul>

<p>As mentioned before, the OS_App_Defines.h header file is included early, before board/family/architecture files.</p>

<p>Being also included in preprocessed assembly files, one <strong>specific requirement</strong> for OS_Defines.h and nested files is to <strong>include only preprocessor definitions, and not C/C++ definitions</strong>.</p>

<h2 id="osh-for-system-classes">OS.h (for system classes)</h2>

<p>Regular system source files, in addition to preprocessor definitions, also need the definitions of the system classes, so instead of OS.h, the <strong>portable/kernel/include/OS.h</strong> header file should be used.</p>

<p>The inclusion chain in OS.h is:</p>

<ul>
  <li>include <strong>OS_Defines.h</strong>
</li>
  <li>include <stdint.h> for uint8_t, int8_t and other</stdint.h>
</li>
  <li>define uchar_t, uint_t, ulong_t</li>
  <li>include <cstddef> for std::size_t</cstddef>
</li>
  <li>define the <strong>OSImpl</strong> class</li>
  <li>define the <strong>OSSchedulerImpl</strong> class</li>
  <li>define the <strong>OSApplicationImpl</strong> class</li>
  <li>include <strong>OSScheduler.h</strong>
</li>
  <li>include <strong>OSTask.h</strong>
</li>
  <li>include <strong>OSTimer.h</strong>, OSTimerSeconds.h, OSTimerTicks.h, Timer.h</li>
  <li>include <strong>OSDeviceDebug.h</strong>
</li>
  <li>define the <strong>OSReturn</strong> class</li>
  <li>define the <strong>OSTimeout</strong> class</li>
  <li>define the <strong>OS</strong> class, derived from OSImpl</li>
  <li>based on the architecture definition, selectively include <strong>OS_Arch_Inlines.h</strong>
</li>
  <li>based on the architecture family definition, selectively include <strong>OS_Family_Inlines.h</strong>
</li>
</ul>

<h2 id="uosh-for-application-classes">uOS.h (for application classes)</h2>

<p>As a single inclusion point for application source files, the inclusion chain in uOS.h is:</p>

<ul>
  <li>include <strong>OS.h</strong>
</li>
  <li>based on various OS_INCLUDE_* variables, selectively include all other header files not already included in OS.h, like OSMutex.h, etc</li>
  <li>define all system global variables as extern</li>
  <li>include <strong>App_Defines.h</strong>
</li>
  <li>define other application variables based on definitions in App_Defines.h</li>
</ul>

<p>The place of App_Defines.h is at the end of the inclusion chain, so none of the definitions present here can change anything in the system configuration, only in the application configuration.</p>








<ul class="share-buttons">
  <li><div class="tw-share-button"><a href="https://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a></div></li>
  <li><div class="fb-share-button" data-href="http://micro-os-plus.github.io/micro-os-plus/i/Application_configuration/" data-layout="button"></div></li>
</ul>



      </div>

    </div>
  </div>

</div>

<div class="container">

  <div class="site-footer">
  <div class="site-footer-links left">
    <ul>
  <li>© 2019 Liviu Ionescu</li>
  <li>Hosted on GitHub</li>
  <li><a href="/feed.xml"><img src="/assets/images/feed-20.png" alt="RSS"></a></li>
  <li>
<a href="http://twitter.com/micro_os_plus" class="twitter-follow-button" data-show-count="false">Follow @micro_os_plus</a><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</li>
</ul>


  </div>
  <a href="https://github.com/micro-os-plus/micro-os-plus-iii" aria-label="Homepage">
      <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
  </a>
  <div class="site-footer-links right">
    <ul>
  <li><a href="/">Home</a></li>
  <li><a href="/blog/">News</a></li>
  <li><a href="https://github.com/micro-os-plus/micro-os-plus-iii/releases">Releases</a></li>
  <li><a href="https://github.com/micro-os-plus/micro-os-plus-iii/issues">Support</a></li>
  <li><a href="/about/">About</a></li>
</ul>

  </div>
</div>


</div>

</body>
</html>
